<!-- src/app/pages/book-detail/book-detail.component.html -->
<div class="book-detail-page">
  <!-- Indicateur de chargement -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>

  <!-- Contenu principal -->
  <ng-container *ngIf="!isLoading && !errorMessage">
    <ng-container *ngIf="(book$ | async) as book; else notFound">

      <main class="book-content">
        <div class="layout">

          <!-- Couverture -->
          <div class="book-cover">
            <img
              [src]="book.coverUrl || 'assets/images/placeholder.png'"
              [alt]="'Couverture du livre : ' + book.title"
              class="cover-img"
            />
          </div>

          <!-- Détails du livre -->
          <div class="book-info">
            <header class="book-header">
              <div class="book-category" *ngIf="book.category">{{ book.category }}</div>
              <h1 class="book-title">{{ book.title }}</h1>
              <h2 class="book-author">par {{ book.author }}</h2>
            </header>

            <section class="summary-section">
              <h3>Résumé</h3>
              <p *ngIf="book.summary; else noSummary">{{ book.summary }}</p>
              <ng-template #noSummary>
                <p class="summary-placeholder">Aucun résumé disponible.</p>
              </ng-template>
            </section>

            <section class="purchase-section">
              <div class="price">Prix : <span>{{ book.price | currency:'EUR':'symbol':'1.2-2':'fr' }}</span></div>
              <div class="buttons">
                <button class="btn primary" (click)="buyBook(book.id)">Acheter</button>
                <button class="btn secondary" (click)="addToLibrary(book.id)">Ajouter aux favoris</button>
              </div>
            </section>

            <footer class="footer">
              <button class="btn-link" (click)="goBack()">&larr; Voir d'autres livres</button>
            </footer>
          </div>

        </div>
      </main>

    </ng-container>

    <ng-template #notFound>
      <section class="not-found">
        <p>Ce livre n’a pas été trouvé.</p>
        <a routerLink="/" class="btn">Retour à l’accueil</a>
      </section>
    </ng-template>
  </ng-container>
</div>
