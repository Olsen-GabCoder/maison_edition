<!-- src/app/admin/components/book-form/book-form.component.html -->
<!-- Liaison du formulaire au FormGroup 'bookForm' -->
<form [formGroup]="bookForm" (ngSubmit)="onSubmit()" novalidate>

  <!-- Affichage de l'erreur générale venant du parent -->
  <div *ngIf="generalError" class="alert alert-danger general-form-error">
    <strong>Erreur :</strong> {{ generalError }}
  </div>

  <!-- Champ Titre -->
  <div class="form-group mb-3">
    <label for="title" class="form-label">Titre <span class="text-danger">*</span></label>
    <input type="text" id="title" class="form-control" formControlName="title"
           placeholder="Entrez le titre du livre"
           [ngClass]="{ 'is-invalid': isInvalid('title') }">
    <!-- Affichage conditionnel des erreurs pour 'title' -->
    <div *ngIf="isInvalid('title')" class="invalid-feedback">
      {{ getErrorMessage('title') }}
    </div>
  </div>

  <!-- Champ Auteur -->
  <div class="form-group mb-3">
    <label for="author" class="form-label">Auteur <span class="text-danger">*</span></label>
    <input type="text" id="author" class="form-control" formControlName="author"
           placeholder="Nom de l'auteur"
           [ngClass]="{ 'is-invalid': isInvalid('author') }">
    <div *ngIf="isInvalid('author')" class="invalid-feedback">
      {{ getErrorMessage('author') }}
    </div>
  </div>

  <!-- Champ ISBN -->
  <div class="form-group mb-3">
    <label for="isbn" class="form-label">ISBN</label>
    <input type="text" id="isbn" class="form-control" formControlName="isbn"
           placeholder="ISBN-10 ou ISBN-13 (ex: 9782070360536)"
           [ngClass]="{ 'is-invalid': isInvalid('isbn') }">
    <div *ngIf="isInvalid('isbn')" class="invalid-feedback">
      {{ getErrorMessage('isbn') }}
    </div>
  </div>

  <!-- Champ Description -->
  <div class="form-group mb-3">
    <label for="description" class="form-label">Description</label>
    <textarea id="description" class="form-control" formControlName="description" rows="4"
              placeholder="Brève description du livre"
              [ngClass]="{ 'is-invalid': isInvalid('description') }"></textarea>
    <div *ngIf="isInvalid('description')" class="invalid-feedback">
      {{ getErrorMessage('description') }}
    </div>
  </div>

  <!-- Ligne pour Prix et Stock -->
  <div class="row mb-3">
    <!-- Champ Prix -->
    <div class="col-md-6 form-group">
      <label for="price" class="form-label">Prix (€) <span class="text-danger">*</span></label>
      <input type="number" id="price" class="form-control" formControlName="price"
             placeholder="0.00" step="0.01" min="0"
             [ngClass]="{ 'is-invalid': isInvalid('price') }">
      <div *ngIf="isInvalid('price')" class="invalid-feedback">
        {{ getErrorMessage('price') }}
      </div>
    </div>

    <!-- Champ Stock -->
    <div class="col-md-6 form-group">
      <label for="stock" class="form-label">Stock</label>
      <input type="number" id="stock" class="form-control" formControlName="stock"
             placeholder="Quantité disponible" min="0" step="1"
             [ngClass]="{ 'is-invalid': isInvalid('stock') }">
      <div *ngIf="isInvalid('stock')" class="invalid-feedback">
        {{ getErrorMessage('stock') }}
      </div>
    </div>
  </div>

  <!-- Ligne pour Date de publication et Catégorie -->
   <div class="row mb-3">
     <!-- Champ Date de publication -->
     <div class="col-md-6 form-group">
       <label for="publishedDate" class="form-label">Date de publication</label>
       <input type="date" id="publishedDate" class="form-control"
              formControlName="publishedDate"
              [ngClass]="{ 'is-invalid': isInvalid('publishedDate') }">
       <div *ngIf="isInvalid('publishedDate')" class="invalid-feedback">
         {{ getErrorMessage('publishedDate') }}
       </div>
     </div>

     <!-- Champ Catégorie -->
     <div class="col-md-6 form-group">
       <label for="category" class="form-label">Catégorie</label>
       <input type="text" id="category" class="form-control" formControlName="category"
              placeholder="Ex: Fantasy, Science-Fiction"
              [ngClass]="{ 'is-invalid': isInvalid('category') }">
       <div *ngIf="isInvalid('category')" class="invalid-feedback">
         {{ getErrorMessage('category') }}
       </div>
     </div>
   </div>


  <!-- Boutons d'action -->
  <div class="form-actions d-flex justify-content-end gap-2 mt-4">
    <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="isSubmitting">
      Annuler
    </button>
    <button type="submit" class="btn btn-primary" [disabled]="isSubmitting || bookForm.invalid">
      <span *ngIf="!isSubmitting">{{ isEditMode ? 'Mettre à jour' : 'Ajouter le livre' }}</span>
      <span *ngIf="isSubmitting">
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        Enregistrement...
      </span>
    </button>
  </div>

</form>